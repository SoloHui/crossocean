### VIM 的四种模式（核心概念）

理解模式是掌握 VIM 的关键：

1.  **普通模式**：打开文件后默认进入的模式。用于移动光标、删除、复制、粘贴等操作。按 `Esc` 可随时返回此模式。
2.  **插入模式**：在此模式下才能输入文本。从普通模式按 `i`、`a`、`o` 等键进入。
3.  **可视模式**：用于选择文本块。从普通模式按 `v`（字符选择）、`V`（行选择）、`Ctrl+v`（块选择）进入。
4.  **命令行模式**：用于执行保存、退出、搜索替换等高级命令。从普通模式按 `:` 进入。

---

### 一、启动与退出 VIM

| 命令 | 说明 |
| :--- | :--- |
| `vim filename` | 打开或新建文件 |
| `vim +n filename` | 打开文件并将光标定位到第 n 行 |
| `:q` | 退出（如果文件有更改会提示） |
| `:q!` | **强制退出，不保存更改** |
| `:w` | 保存 |
| `:wq` 或 `:x` 或 `ZZ` | 保存并退出 |
| `:w filename` | 另存为 |
| `:wq!` | 强制保存并退出（用于只读文件） |

---

### 二、移动光标（普通模式下）

#### 基本移动

| 命令 | 说明 |
| :--- | :--- |
| `h` `j` `k` `l` | 左、下、上、右（等同于方向键） |
| `w` | 移动到下一个单词的开头 |
| `b` | 移动到上一个单词的开头 |
| `e` | 移动到当前单词的末尾 |
| `0` | 移动到行首 |
| `^` | 移动到行首的第一个非空白字符 |
| `$` | 移动到行尾 |
| `gg` | 移动到文件第一行 |
| `G` | 移动到文件最后一行 |
| `nG` 或 `:n` | 移动到第 n 行 |
| `Ctrl + f` | 向下翻页 |
| `Ctrl + b` | 向上翻页 |
| `H` | 移动到当前屏幕顶部 |
| `M` | 移动到当前屏幕中间 |
| `L` | 移动到当前屏幕底部 |

---

### 三、插入与编辑文本

#### 进入插入模式

| 命令 | 说明 |
| :--- | :--- |
| `i` | 在光标**前**插入 |
| `a` | 在光标**后**插入 |
| `I` | 在**行首**插入 |
| `A` | 在**行尾**插入 |
| `o` | 在**当前行下方**新建一行并插入 |
| `O` | 在**当前行上方**新建一行并插入 |
| `s` | 删除当前字符并插入 |
| `S` 或 `cc` | 删除整行并插入 |

#### 删除与撤销

| 命令 | 说明 |
| :--- | :--- |
| `x` | 删除光标下的字符 |
| `X` | 删除光标前的字符 |
| `dw` | 删除一个单词（从光标处开始） |
| `dd` | **删除当前行** |
| `ndd` | 删除 n 行（例如 `5dd` 删除 5 行） |
| `d$` 或 `D` | 删除从光标到行尾的内容 |
| `d0` | 删除从光标到行首的内容 |
| `u` | **撤销** |
| `Ctrl + r` | **重做**（恢复撤销） |

#### 复制、剪切与粘贴

| 命令 | 说明 |
| :--- | :--- |
| `yy` | **复制当前行** |
| `nyy` | 复制 n 行 |
| `yw` | 复制一个单词 |
| `y$` | 复制到行尾 |
| `p` | 在光标**后**粘贴 |
| `P` | 在光标**前**粘贴 |
| `dd` + `p` | 实现**剪切**效果（先删除，再粘贴） |

---

### 四、搜索与替换

#### 搜索

| 命令 | 说明 |
| :--- | :--- |
| `/pattern` | 向后搜索字符串 "pattern" |
| `?pattern` | 向前搜索字符串 "pattern" |
| `n` | 继续搜索下一个 |
| `N` | 继续搜索上一个 |
| `*` | 向下搜索当前光标所在的单词 |
| `#` | 向上搜索当前光标所在的单词 |

#### 替换（命令行模式）

| 命令 | 说明 |
| :--- | :--- |
| `:s/old/new` | 将当前行第一个 "old" 替换为 "new" |
| `:s/old/new/g` | 将当前行**所有** "old" 替换为 "new" |
| `:%s/old/new/g` | **全局替换**，将文件中所有 "old" 替换为 "new" |
| `:%s/old/new/gc` | 全局替换，但**每次替换前会确认** |
| `:n1,n2s/old/new/g` | 将第 n1 行到第 n2 行之间的所有 "old" 替换为 "new" |

---

### 五、可视模式操作

| 命令 | 说明 |
| :--- | :--- |
| `v` | 进入字符可视模式 |
| `V` | 进入行可视模式 |
| `Ctrl + v` | 进入块可视模式（非常强大） |
| 选中后按 `d` | 删除选中的文本 |
| 选中后按 `y` | 复制选中的文本 |
| 选中后按 `>` | 向右缩进选中的文本 |
| 选中后按 `<` | 向左缩进选中的文本 |

---

### 六、分屏与多文件操作

| 命令 | 说明 |
| :--- | :--- |
| `:sp filename` | 水平分屏，打开新文件 |
| `:vsp filename` | 垂直分屏，打开新文件 |
| `Ctrl + ww` | 在窗口间循环切换 |
| `Ctrl + w` + `h/j/k/l` | 向左/下/上/右切换窗口 |
| `:bn` | 切换到下一个缓冲区（文件） |
| `:bp` | 切换到上一个缓冲区（文件） |
| `:ls` | 列出所有打开的缓冲区 |
| `:bd` | 关闭当前缓冲区 |

---

### 七、实用高级技巧

| 命令 | 说明 |
| :--- | :--- |
| `.` | **重复上一个操作**（极其强大） |
| `J` | 将下一行合并到当前行（去除换行符） |
| `>>` | 当前行向右缩进 |
| `<<` | 当前行向左缩进 |
| `Ctrl + n` / `Ctrl + p` | 插入模式下的代码补全 |
| `:set number` 或 `:set nu` | 显示行号 |
| `:set nonumber` 或 `:set nonu` | 隐藏行号 |
| `:set paste` | 进入粘贴模式（防止自动缩进混乱） |
| `:set nopaste` | 退出粘贴模式 |
| `:r filename` | 将另一个文件的内容插入到当前光标后 |
| `:!command` | 执行外部 shell 命令（如 `:!ls`） |

### 学习建议

1.  **不要死记硬背**：从最常用的命令开始（`i`, `Esc`, `:wq`, `dd`, `yy`, `p`, `u`）。
2.  **强制自己使用**：在终端里编辑配置文件、写代码时，刻意使用 VIM。
3.  **玩游戏练习**：`vimtutor` 是内置的官方教程，`vim-adventures.com` 是一个有趣的游戏化学习网站。
4.  **打印一份速查表**：放在手边，随时查阅。